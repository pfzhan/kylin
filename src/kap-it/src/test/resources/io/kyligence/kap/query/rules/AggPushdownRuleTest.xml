<?xml version="1.0" ?>
<!--
/**
 * Copyright (C) 2020 Kyligence Inc. All rights reserved.
 *
 * http://kyligence.io
 *
 * This software is the confidential and proprietary information of
 * Kyligence Inc. ("Confidential Information"). You shall not disclose
 * such Confidential Information and shall use it only in accordance
 * with the terms of the license agreement you entered into with
 * Kyligence Inc.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
-->

<Root>
    <TestCase name="testAggPushdown">
        <Resource name="query01.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($17, 164000), '[0,164000)', <($17, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$8], ctx=[])
      KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
        KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query01.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($0, 164000), '[0,164000)', <($0, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$1], ctx=[])
      KapAggregateRel(group-set=[[1]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
        KapFilterRel(condition=[<>($0, 'Auction')], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$0], X_measure__0=[$3], usr_GMV_SUM_ok=[$1], ctx=[])
            KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
              KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
              KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
                KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                  KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                    KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query02.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0, 1]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($17, 164000), '[0,164000)', <($17, 166000), '[164000, 166000)', '[166000, +∞')], LSTG_FORMAT_NAME=[$16], PRICE=[$8], ctx=[])
      KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
        KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query02.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0, 1]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($1, 164000), '[0,164000)', <($1, 166000), '[164000, 166000)', '[166000, +∞')], LSTG_FORMAT_NAME=[$0], PRICE=[$2], ctx=[])
      KapAggregateRel(group-set=[[1, 2]], groups=[null], usr_GMV_SUM_ok=[SUM($3)], ctx=[])
        KapFilterRel(condition=[<>($0, 'Auction')], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$0], LSTG_FORMAT_NAME0=[$2], X_measure__0=[$3], usr_GMV_SUM_ok=[$1], ctx=[])
            KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
              KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
              KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
                KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                  KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                    KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query03.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($1, 164000), '[0,164000)', <($1, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$10], ctx=[])
      KapFilterRel(condition=[<>($5, 'Auction')], ctx=[])
        KapJoinRel(condition=[=($0, $5)], joinType=[inner], ctx=[])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query03.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($0, 164000), '[0,164000)', <($0, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$1], ctx=[])
      KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
        KapFilterRel(condition=[<>($1, 'Auction')], ctx=[])
          KapProjectRel(X_measure__0=[$1], LSTG_FORMAT_NAME=[$2], usr_GMV_SUM_ok=[$3], ctx=[])
            KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
              KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
                KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                  KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                    KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
              KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query04.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($22, 164000), '[0,164000)', <($22, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$8], ctx=[])
      KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
        KapJoinRel(condition=[=($3, $21)], joinType=[inner], ctx=[])
          KapJoinRel(condition=[=($7, $16)], joinType=[inner], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
            KapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapJoinRel(condition=[=($7, $16)], joinType=[inner], ctx=[])
                  KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
                  KapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
]]>
        </Resource>
        <Resource name="query04.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($0, 164000), '[0,164000)', <($0, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$1], ctx=[])
      KapAggregateRel(group-set=[[1]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
        KapFilterRel(condition=[<>($0, 'Auction')], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$0], X_measure__0=[$3], usr_GMV_SUM_ok=[$1], ctx=[])
            KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
              KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
                KapJoinRel(condition=[=($7, $16)], joinType=[inner], ctx=[])
                  KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
                  KapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
              KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
                KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                  KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                    KapJoinRel(condition=[=($7, $16)], joinType=[inner], ctx=[])
                      KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
                      KapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
]]>
        </Resource>
        <Resource name="query05.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[$17], PRICE=[$8], ctx=[])
      KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
        KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query05.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[1]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
    KapFilterRel(condition=[<>($0, 'Auction')], ctx=[])
      KapProjectRel(LSTG_FORMAT_NAME=[$0], X_measure__0=[$3], usr_GMV_SUM_ok=[$1], ctx=[])
        KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
          KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query06.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(AND(<($17, 164000), =($16, 'ABIN')), '[0,164000)', AND(<($17, 166000), =($16, 'ABIN')), '[164000, 166000)', '[166000, +∞')], PRICE=[$8], ctx=[])
      KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
        KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query06.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(AND(<($1, 164000), =($0, 'ABIN')), '[0,164000)', AND(<($1, 166000), =($0, 'ABIN')), '[164000, 166000)', '[166000, +∞')], PRICE=[$2], ctx=[])
      KapAggregateRel(group-set=[[1, 2]], groups=[null], usr_GMV_SUM_ok=[SUM($3)], ctx=[])
        KapFilterRel(condition=[<>($0, 'Auction')], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$0], LSTG_FORMAT_NAME0=[$2], X_measure__0=[$3], usr_GMV_SUM_ok=[$1], ctx=[])
            KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
              KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
              KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
                KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                  KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                    KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query07.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_COUNT_ok=[COUNT($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($17, 164000), '[0,164000)', <($17, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$8], ctx=[])
      KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
        KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query07.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_COUNT_ok=[$SUM0($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($0, 164000), '[0,164000)', <($0, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$1], ctx=[])
      KapAggregateRel(group-set=[[1]], groups=[null], usr_GMV_COUNT_ok=[$SUM0($2)], ctx=[])
        KapFilterRel(condition=[<>($0, 'Auction')], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$0], X_measure__0=[$3], usr_GMV_COUNT_ok=[$1], ctx=[])
            KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
              KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_COUNT_ok=[COUNT($8)], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
              KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
                KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                  KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                    KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAddRules">
        <Resource name="query01.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($17, 164000), '[0,164000)', <($17, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$8], ctx=[])
      KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
        KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query01.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($0, 164000), '[0,164000)', <($0, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$1], ctx=[])
      KapAggregateRel(group-set=[[1]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
        KapFilterRel(condition=[<>($0, 'Auction')], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$0], X_measure__0=[$3], usr_GMV_SUM_ok=[$1], ctx=[])
            KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
              KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
              KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
                KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                  KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                    KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query02.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0, 1]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($17, 164000), '[0,164000)', <($17, 166000), '[164000, 166000)', '[166000, +∞')], LSTG_FORMAT_NAME=[$16], PRICE=[$8], ctx=[])
      KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
        KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query02.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0, 1]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($1, 164000), '[0,164000)', <($1, 166000), '[164000, 166000)', '[166000, +∞')], LSTG_FORMAT_NAME=[$0], PRICE=[$2], ctx=[])
      KapAggregateRel(group-set=[[1, 2]], groups=[null], usr_GMV_SUM_ok=[SUM($3)], ctx=[])
        KapFilterRel(condition=[<>($0, 'Auction')], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$0], LSTG_FORMAT_NAME0=[$2], X_measure__0=[$3], usr_GMV_SUM_ok=[$1], ctx=[])
            KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
              KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
              KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
                KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                  KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                    KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query03.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($1, 164000), '[0,164000)', <($1, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$10], ctx=[])
      KapFilterRel(condition=[<>($5, 'Auction')], ctx=[])
        KapJoinRel(condition=[=($0, $5)], joinType=[inner], ctx=[])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query03.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($0, 164000), '[0,164000)', <($0, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$1], ctx=[])
      KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
        KapFilterRel(condition=[<>($1, 'Auction')], ctx=[])
          KapProjectRel(X_measure__0=[$1], LSTG_FORMAT_NAME=[$2], usr_GMV_SUM_ok=[$3], ctx=[])
            KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
              KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
                KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                  KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                    KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
              KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query04.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($22, 164000), '[0,164000)', <($22, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$8], ctx=[])
      KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
        KapJoinRel(condition=[=($3, $21)], joinType=[inner], ctx=[])
          KapJoinRel(condition=[=($7, $16)], joinType=[inner], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
            KapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapJoinRel(condition=[=($7, $16)], joinType=[inner], ctx=[])
                  KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
                  KapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
]]>
        </Resource>
        <Resource name="query04.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($0, 164000), '[0,164000)', <($0, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$1], ctx=[])
      KapAggregateRel(group-set=[[1]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
        KapFilterRel(condition=[<>($0, 'Auction')], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$0], X_measure__0=[$3], usr_GMV_SUM_ok=[$1], ctx=[])
            KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
              KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
                KapJoinRel(condition=[=($7, $16)], joinType=[inner], ctx=[])
                  KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
                  KapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
              KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
                KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                  KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                    KapJoinRel(condition=[=($7, $16)], joinType=[inner], ctx=[])
                      KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
                      KapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
]]>
        </Resource>
        <Resource name="query05.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[$17], PRICE=[$8], ctx=[])
      KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
        KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query05.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[1]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
    KapFilterRel(condition=[<>($0, 'Auction')], ctx=[])
      KapProjectRel(LSTG_FORMAT_NAME=[$0], X_measure__0=[$3], usr_GMV_SUM_ok=[$1], ctx=[])
        KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
          KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query06.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(AND(<($17, 164000), =($16, 'ABIN')), '[0,164000)', AND(<($17, 166000), =($16, 'ABIN')), '[164000, 166000)', '[166000, +∞')], PRICE=[$8], ctx=[])
      KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
        KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query06.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(AND(<($1, 164000), =($0, 'ABIN')), '[0,164000)', AND(<($1, 166000), =($0, 'ABIN')), '[164000, 166000)', '[166000, +∞')], PRICE=[$2], ctx=[])
      KapAggregateRel(group-set=[[1, 2]], groups=[null], usr_GMV_SUM_ok=[SUM($3)], ctx=[])
        KapFilterRel(condition=[<>($0, 'Auction')], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$0], LSTG_FORMAT_NAME0=[$2], X_measure__0=[$3], usr_GMV_SUM_ok=[$1], ctx=[])
            KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
              KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
              KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
                KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                  KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                    KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query07.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_COUNT_ok=[COUNT($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($17, 164000), '[0,164000)', <($17, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$8], ctx=[])
      KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
        KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query07.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_COUNT_ok=[$SUM0($1)], ctx=[])
    KapProjectRel(Calculation_1162491713472385025=[CASE(<($0, 164000), '[0,164000)', <($0, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$1], ctx=[])
      KapAggregateRel(group-set=[[1]], groups=[null], usr_GMV_COUNT_ok=[$SUM0($2)], ctx=[])
        KapFilterRel(condition=[<>($0, 'Auction')], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$0], X_measure__0=[$3], usr_GMV_COUNT_ok=[$1], ctx=[])
            KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
              KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_COUNT_ok=[COUNT($8)], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
              KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
                KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
                  KapFilterRel(condition=[<>($3, 'Auction')], ctx=[])
                    KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggProjectMergeRule">
        <Resource name="query05.planBefore">
            <![CDATA[
KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
  KapProjectRel(Calculation_1162491713472385025=[$17], PRICE=[$8], ctx=[])
    KapFilterRel(condition=[NOT(=($3, 'Auction'))], ctx=[])
      KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
        KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
        KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
            KapFilterRel(condition=[NOT(=($3, 'Auction'))], ctx=[])
              KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query05.planAfter">
            <![CDATA[
KapAggregateRel(group-set=[[17]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
  KapFilterRel(condition=[NOT(=($3, 'Auction'))], ctx=[])
    KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
      KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
      KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
        KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
          KapFilterRel(condition=[NOT(=($3, 'Auction'))], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggProjectTransposeRule">
        <Resource name="query01.planBefore">
            <![CDATA[
KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
  KapProjectRel(Calculation_1162491713472385025=[CASE(<($17, 164000), '[0,164000)', <($17, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$8], ctx=[])
    KapFilterRel(condition=[NOT(=($3, 'Auction'))], ctx=[])
      KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
        KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
        KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
            KapFilterRel(condition=[NOT(=($3, 'Auction'))], ctx=[])
              KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query01.planAfter">
            <![CDATA[
KapAggregateRel(group-set=[[0]], groups=[null], usr_GMV_SUM_ok=[SUM($1)], ctx=[])
  KapProjectRel(Calculation_1162491713472385025=[CASE(<($0, 164000), '[0,164000)', <($0, 166000), '[164000, 166000)', '[166000, +∞')], PRICE=[$1], ctx=[])
    KapAggregateRel(group-set=[[17]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
      KapFilterRel(condition=[NOT(=($3, 'Auction'))], ctx=[])
        KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
          KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
            KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
              KapFilterRel(condition=[NOT(=($3, 'Auction'))], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggFilterTransposeRule">
        <Resource name="query05.planBefore">
            <![CDATA[
KapAggregateRel(group-set=[[17]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
  KapFilterRel(condition=[NOT(=($3, 'Auction'))], ctx=[])
    KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
      KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
      KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
        KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
          KapFilterRel(condition=[NOT(=($3, 'Auction'))], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query05.planAfter">
            <![CDATA[
KapAggregateRel(group-set=[[1]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
  KapFilterRel(condition=[NOT(=($0, 'Auction'))], ctx=[])
    KapAggregateRel(group-set=[[3, 17]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
      KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
        KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
        KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
            KapFilterRel(condition=[NOT(=($3, 'Auction'))], ctx=[])
              KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAggJoinTransposeRule">
        <Resource name="query05.planBefore">
            <![CDATA[
KapAggregateRel(group-set=[[1]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
  KapFilterRel(condition=[NOT(=($0, 'Auction'))], ctx=[])
    KapAggregateRel(group-set=[[3, 17]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
      KapJoinRel(condition=[=($3, $16)], joinType=[inner], ctx=[])
        KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
        KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
            KapFilterRel(condition=[NOT(=($3, 'Auction'))], ctx=[])
              KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
        <Resource name="query05.planAfter">
            <![CDATA[
KapAggregateRel(group-set=[[1]], groups=[null], usr_GMV_SUM_ok=[SUM($2)], ctx=[])
  KapFilterRel(condition=[NOT(=($0, 'Auction'))], ctx=[])
    KapProjectRel(LSTG_FORMAT_NAME=[$0], X_measure__0=[$3], usr_GMV_SUM_ok=[$1], ctx=[])
      KapJoinRel(condition=[=($0, $2)], joinType=[inner], ctx=[])
        KapAggregateRel(group-set=[[3]], groups=[null], usr_GMV_SUM_ok=[SUM($8)], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
        KapAggregateRel(group-set=[[0]], groups=[null], X_measure__0=[SUM($1)], ctx=[])
          KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], ctx=[])
            KapFilterRel(condition=[NOT(=($3, 'Auction'))], ctx=[])
              KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]])
]]>
        </Resource>
    </TestCase>
</Root>
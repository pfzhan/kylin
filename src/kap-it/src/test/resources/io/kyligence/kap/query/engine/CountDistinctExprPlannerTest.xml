<?xml version="1.0" ?>
<!--
/**
 * Copyright (C) 2020 Kyligence Inc. All rights reserved.
 *
 * http://kyligence.io
 *
 * This software is the confidential and proprietary information of
 * Kyligence Inc. ("Confidential Information"). You shall not disclose
 * such Confidential Information and shall use it only in accordance
 * with the terms of the license agreement you entered into with
 * Kyligence Inc.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
-->

<Root>
    <TestCase name="testSimpleCountDistinctExpr">
        <Resource name="planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[COUNT(DISTINCT $0)], ctx=[])
    KapProjectRel($f0=[CASE(=($3, 'FP-NON GTC'), $8, null)], ctx=[])
      KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], AGG$0=[BITMAP_COUNT($0)], ctx=[])
    KapProjectRel($f0=[CASE(=($0, 'FP-NON GTC'), $1, null)], ctx=[])
      KapAggregateRel(group-set=[[0]], groups=[null], COUNT_DISTINCT_CASE$0$0=[BITMAP_UUID($1)], ctx=[])
        KapProjectRel(LSTG_FORMAT_NAME=[$3], PRICE=[$8], $f2=[0], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAllCases">
        <Resource name="query00.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[COUNT(DISTINCT $0)], ctx=[])
    KapProjectRel($f0=[CASE(=($2, 2012-10-30), $8, null)], ctx=[])
      KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query00.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], AGG$0=[BITMAP_COUNT($0)], ctx=[])
    KapProjectRel($f0=[CASE(=($0, 2012-10-30), $1, null)], ctx=[])
      KapAggregateRel(group-set=[[0]], groups=[null], COUNT_DISTINCT_CASE$0$0=[BITMAP_UUID($1)], ctx=[])
        KapProjectRel(CAL_DT=[$2], PRICE=[$8], $f2=[0], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query01.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[COUNT(DISTINCT $0)], ctx=[])
    KapProjectRel($f0=[CASE(AND(=($2, 2012-10-30), >($7, 1)), $8, null)], ctx=[])
      KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query01.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], AGG$0=[BITMAP_COUNT($0)], ctx=[])
    KapProjectRel($f0=[CASE(AND(=($0, 2012-10-30), >($1, 1)), $2, null)], ctx=[])
      KapAggregateRel(group-set=[[0, 1]], groups=[null], COUNT_DISTINCT_CASE$0$0=[BITMAP_UUID($2)], ctx=[])
        KapProjectRel(CAL_DT=[$2], SELLER_ID=[$7], PRICE=[$8], $f3=[0], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query02.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[COUNT(DISTINCT $0)], EXPR$1=[COUNT(DISTINCT $1)], EXPR$2=[COUNT(DISTINCT $2)], ctx=[])
    KapProjectRel($f0=[CASE(AND(=($2, 2012-10-30), >($7, 1)), $8, null)], $f1=[CASE(>($7, 1), $8, null)], $f2=[CASE(>($9, 0), null, $8)], ctx=[])
      KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query02.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], AGG$0=[BITMAP_COUNT($0)], AGG$1=[BITMAP_COUNT($1)], AGG$2=[BITMAP_COUNT($2)], ctx=[])
    KapProjectRel($f0=[CASE(AND(=($0, 2012-10-30), >($1, 1)), $4, null)], $f1=[CASE(>($2, 1), $5, null)], $f2=[CASE(>($3, 0), null, $6)], ctx=[])
      KapAggregateRel(group-set=[[0, 1, 4, 7]], groups=[null], COUNT_DISTINCT_CASE$0$0=[BITMAP_UUID($2)], COUNT_DISTINCT_CASE$1$0=[BITMAP_UUID($5)], COUNT_DISTINCT_CASE$2$1=[BITMAP_UUID($9)], ctx=[])
        KapProjectRel(CAL_DT=[$2], SELLER_ID=[$7], PRICE=[$8], $f3=[0], SELLER_ID0=[$7], PRICE0=[$8], $f6=[0], ITEM_COUNT=[$9], $f8=[0], PRICE01=[$8], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query03.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapUnionRel(all=[false], ctx=[], all=[false])
    KapProjectRel(EXPR$0=[$0], ctx=[])
      KapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[COUNT(DISTINCT $0)], ctx=[])
        KapProjectRel($f0=[CASE(AND(=($2, 2012-10-30), >($7, 1)), $8, null)], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
    KapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[COUNT(DISTINCT $0)], ctx=[])
      KapProjectRel($f0=[CASE(>($7, 1), $8, null)], ctx=[])
        KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query03.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapUnionRel(all=[false], ctx=[], all=[false])
    KapProjectRel(EXPR$0=[$0], ctx=[])
      KapAggregateRel(group-set=[[]], groups=[null], AGG$0=[BITMAP_COUNT($0)], ctx=[])
        KapProjectRel($f0=[CASE(AND(=($0, 2012-10-30), >($1, 1)), $2, null)], ctx=[])
          KapAggregateRel(group-set=[[0, 1]], groups=[null], COUNT_DISTINCT_CASE$0$0=[BITMAP_UUID($2)], ctx=[])
            KapProjectRel(CAL_DT=[$2], SELLER_ID=[$7], PRICE=[$8], $f3=[0], ctx=[])
              KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
    KapAggregateRel(group-set=[[]], groups=[null], AGG$0=[BITMAP_COUNT($0)], ctx=[])
      KapProjectRel($f0=[CASE(>($0, 1), $1, null)], ctx=[])
        KapAggregateRel(group-set=[[0]], groups=[null], COUNT_DISTINCT_CASE$0$0=[BITMAP_UUID($1)], ctx=[])
          KapProjectRel(SELLER_ID=[$7], PRICE=[$8], $f2=[0], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query04.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapProjectRel(CNT1=[$0], CNT2=[$3], CAL_DT=[$1], ctx=[])
    KapJoinRel(condition=[=($1, $2)], joinType=[inner], ctx=[])
      KapProjectRel(CNT1=[$1], CAL_DT=[$0], ctx=[])
        KapAggregateRel(group-set=[[0]], groups=[null], CNT1=[COUNT(DISTINCT $1)], ctx=[])
          KapProjectRel(CAL_DT=[$2], $f1=[CASE(AND(=($2, 2012-10-30), >($7, 1)), $8, null)], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
      KapAggregateRel(group-set=[[0]], groups=[null], CNT2=[COUNT(DISTINCT $1)], ctx=[])
        KapProjectRel(CAL_DT=[$2], $f1=[CASE(>($7, 1), $8, null)], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query04.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapProjectRel(CNT1=[$0], CNT2=[$3], CAL_DT=[$1], ctx=[])
    KapJoinRel(condition=[=($1, $2)], joinType=[inner], ctx=[])
      KapProjectRel(CNT1=[$1], CAL_DT=[$0], ctx=[])
        KapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[BITMAP_COUNT($1)], ctx=[])
          KapProjectRel(CAL_DT=[$0], $f1=[CASE(AND(=($1, 2012-10-30), >($2, 1)), $3, null)], ctx=[])
            KapAggregateRel(group-set=[[0, 1, 2]], groups=[null], COUNT_DISTINCT_CASE$0$0=[BITMAP_UUID($3)], ctx=[])
              KapProjectRel(CAL_DT=[$2], CAL_DT0=[$2], SELLER_ID=[$7], PRICE=[$8], $f4=[0], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
      KapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[BITMAP_COUNT($1)], ctx=[])
        KapProjectRel(CAL_DT=[$0], $f1=[CASE(>($1, 1), $2, null)], ctx=[])
          KapAggregateRel(group-set=[[0, 1]], groups=[null], COUNT_DISTINCT_CASE$0$0=[BITMAP_UUID($2)], ctx=[])
            KapProjectRel(CAL_DT=[$2], SELLER_ID=[$7], PRICE=[$8], $f3=[0], ctx=[])
              KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query05.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapProjectRel(CNT1=[$1], CAL_DT=[$0], ctx=[])
    KapAggregateRel(group-set=[[0]], groups=[null], CNT1=[COUNT(DISTINCT $1)], ctx=[])
      KapProjectRel(CAL_DT=[$0], $f1=[CASE(AND(=($0, 2012-10-30), >($1, 1)), CAST($2):BIGINT, null)], ctx=[])
        KapAggregateRel(group-set=[[0, 1]], groups=[null], CNT=[COUNT(DISTINCT $2)], ctx=[])
          KapProjectRel(CAL_DT=[$2], SELLER_ID=[$7], $f2=[CASE(>($9, 1), $8, null)], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query05.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapProjectRel(CNT1=[$1], CAL_DT=[$0], ctx=[])
    KapAggregateRel(group-set=[[0]], groups=[null], CNT1=[COUNT(DISTINCT $1)], ctx=[])
      KapProjectRel(CAL_DT=[$0], $f1=[CASE(AND(=($0, 2012-10-30), >($1, 1)), CAST($2):BIGINT, null)], ctx=[])
        KapAggregateRel(group-set=[[0, 1]], groups=[null], AGG$0=[BITMAP_COUNT($2)], ctx=[])
          KapProjectRel(CAL_DT=[$0], SELLER_ID=[$1], $f2=[CASE(>($2, 1), $3, null)], ctx=[])
            KapAggregateRel(group-set=[[0, 1, 2]], groups=[null], COUNT_DISTINCT_CASE$0$0=[BITMAP_UUID($3)], ctx=[])
              KapProjectRel(CAL_DT=[$2], SELLER_ID=[$7], ITEM_COUNT=[$9], PRICE=[$8], $f4=[0], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query06.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapProjectRel(EXPR$0=[$1], CAL_DT=[$0], EXPR$2=[$2], EXPR$3=[$3], ctx=[])
    KapAggregateRel(group-set=[[0]], groups=[null], EXPR$0=[SUM($1)], EXPR$2=[COUNT(DISTINCT $2)], EXPR$3=[SUM($3)], ctx=[])
      KapProjectRel(CAL_DT=[$2], $f1=[CASE(=($2, 2012-10-30), $8, null)], $f2=[CASE(>($2, 2012-12-01), $10, null)], $f3=[*($8, 9)], ctx=[])
        KapJoinRel(condition=[=($1, $39)], joinType=[left], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
          KapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
]]>
        </Resource>
        <Resource name="query06.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapProjectRel(EXPR$0=[$1], CAL_DT=[$0], EXPR$2=[$2], EXPR$3=[$3], ctx=[])
    KapAggregateRel(group-set=[[0]], groups=[null], AGG$0=[SUM($1)], AGG$1=[BITMAP_COUNT($2)], AGG$2=[SUM($3)], ctx=[])
      KapProjectRel(CAL_DT=[$0], EXPR$0=[$2], $f2=[CASE(>($1, 2012-12-01), $4, null)], EXPR$3=[$3], ctx=[])
        KapProjectRel(CAL_DT=[$0], CAL_DT0=[$1], AGG$0=[$5], AGG$1=[$6], COUNT_DISTINCT_CASE$0$0=[$2], ctx=[])
          KapJoinRel(condition=[AND(=($0, $3), =($1, $4))], joinType=[inner], ctx=[])
            KapAggregateRel(group-set=[[0, 2]], groups=[null], COUNT_DISTINCT_CASE$0$0=[BITMAP_UUID($3)], ctx=[])
              KapProjectRel(CAL_DT=[$2], $f1=[CAST(0):DECIMAL(19, 4)], CAL_DT0=[$2], TEST_COUNT_DISTINCT_BITMAP=[$10], $f4=[0], $f5=[CAST(0):DECIMAL(29, 4)], ctx=[])
                KapJoinRel(condition=[=($1, $39)], joinType=[left], ctx=[])
                  KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                  KapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
            KapAggregateRel(group-set=[[0, 1]], groups=[null], AGG$0=[SUM($2)], AGG$1=[SUM($3)], ctx=[])
              KapProjectRel(CAL_DT=[$0], CAL_DT0=[$1], $f2=[CASE(=($2, 2012-10-30), $4, null)], EXPR$3=[$3], ctx=[])
                KapAggregateRel(group-set=[[0, 1, 2]], groups=[null], TOP_AGG$0=[SUM($3)], TOP_AGG$1=[SUM($4)], TOP_AGG$2=[SUM($5)], ctx=[])
                  KapProjectRel(CAL_DT=[$0], CAL_DT0=[$1], CAL_DT01=[$2], EXPR$3=[$3], SUM_CASE$0$0=[$4], $f5=[*(0, $5)], ctx=[])
                    KapAggregateRel(group-set=[[0, 1, 2]], groups=[null], AGG$0=[SUM($3)], AGG$1=[SUM($4)], AGG$2=[SUM($5)], ctx=[])
                      KapProjectRel(CAL_DT=[$0], CAL_DT0=[$1], CAL_DT01=[$2], $f3=[*($3, 9)], SUM_CASE$0$0=[$4], SUM_CONST$2=[$5], ctx=[])
                        KapAggregateRel(group-set=[[0, 1, 2]], groups=[null], SUM_OP$0=[SUM($3)], SUM_CASE$0$0=[SUM($4)], SUM_CONST$2=[COUNT()], ctx=[])
                          KapProjectRel(CAL_DT=[$2], CAL_DT0=[$2], CAL_DT01=[$2], PRICE=[$8], PRICE0=[$8], ctx=[])
                            KapJoinRel(condition=[=($1, $39)], joinType=[left], ctx=[])
                              KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                              KapTableScan(table=[[DEFAULT, TEST_ORDER]], ctx=[], fields=[[0, 1, 2, 3, 4]])
]]>
        </Resource>
        <Resource name="query07.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[COUNT(DISTINCT $0)], EXPR$1=[SUM($1)], EXPR$2=[COUNT($2)], EXPR$3=[COUNT(DISTINCT $2)], ctx=[])
    KapProjectRel($f0=[CASE(AND(=($2, 2012-10-30), >($7, 1)), $8, null)], PRICE=[$8], LSTG_FORMAT_NAME=[$3], ctx=[])
      KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query07.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapProjectRel(AGG$0=[$1], AGG$1=[$2], AGG$2=[$3], EXPR$3=[$0], ctx=[])
    KapJoinRel(condition=[true], joinType=[inner], ctx=[])
      KapAggregateRel(group-set=[[]], groups=[null], EXPR$3=[COUNT(DISTINCT $2)], ctx=[])
        KapProjectRel($f0=[CAST(0):DECIMAL(19, 4)], $f1=[CAST(0):DECIMAL(19, 4)], LSTG_FORMAT_NAME=[$3], ctx=[])
          KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
      KapAggregateRel(group-set=[[]], groups=[null], AGG$0=[BITMAP_COUNT($0)], AGG$1=[SUM($1)], AGG$2=[$SUM0($2)], ctx=[])
        KapProjectRel($f0=[CASE(AND(=($0, 2012-10-30), >($1, 1)), $4, null)], EXPR$1=[$2], EXPR$2=[$3], ctx=[])
          KapAggregateRel(group-set=[[0, 1]], groups=[null], EXPR$1=[SUM($4)], EXPR$2=[COUNT($5)], COUNT_DISTINCT_CASE$0$0=[BITMAP_UUID($2)], ctx=[])
            KapProjectRel(CAL_DT=[$2], SELLER_ID=[$7], PRICE=[$8], $f3=[0], PRICE0=[$8], LSTG_FORMAT_NAME=[$3], ctx=[])
              KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query08.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[COUNT(DISTINCT $0)], EXPR$1=[COUNT(DISTINCT $1)], EXPR$2=[COUNT(DISTINCT $2)], EXPR$3=[COUNT(DISTINCT $3)], ctx=[])
    KapProjectRel($f0=[CASE(>($2, 2012-12-01), CAST($9):DECIMAL(19, 4), $8)], $f1=[CASE(>($2, 2012-12-01), null, 1)], $f2=[CASE(>($2, 2012-12-01), $9, 1)], $f3=[CASE(>($2, 2012-12-01), -($8, 1), null)], ctx=[])
      KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query08.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[COUNT(DISTINCT $0)], EXPR$1=[COUNT(DISTINCT $1)], EXPR$2=[COUNT(DISTINCT $2)], EXPR$3=[COUNT(DISTINCT $3)], ctx=[])
    KapProjectRel($f0=[CASE(>($2, 2012-12-01), CAST($9):DECIMAL(19, 4), $8)], $f1=[CASE(>($2, 2012-12-01), null, 1)], $f2=[CASE(>($2, 2012-12-01), $9, 1)], $f3=[CASE(>($2, 2012-12-01), -($8, 1), null)], ctx=[])
      KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query09.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[COUNT(DISTINCT $0)], ctx=[])
    KapProjectRel($f0=[CASE(>($2, 2012-12-01), $39, null)], ctx=[])
      KapJoinRel(condition=[=($7, $39)], joinType=[inner], ctx=[])
        KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
        KapAggregateRel(group-set=[[0, 1]], groups=[null], ctx=[])
          KapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
]]>
        </Resource>
        <Resource name="query09.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[COUNT(DISTINCT $0)], ctx=[])
    KapProjectRel($f0=[CASE(>($2, 2012-12-01), $39, null)], ctx=[])
      KapJoinRel(condition=[=($7, $39)], joinType=[inner], ctx=[])
        KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
        KapAggregateRel(group-set=[[0, 1]], groups=[null], ctx=[])
          KapProjectRel(ACCOUNT_ID=[$0], ACCOUNT_COUNTRY=[$3], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
]]>
        </Resource>
        <Resource name="query10.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[COUNT(DISTINCT $0)], ctx=[])
    KapProjectRel($f0=[CASE(AND(=($0, 2012-10-30), >($1, 1)), $2, null)], ctx=[])
      KapUnionRel(all=[false], ctx=[], all=[false])
        KapProjectRel(CAL_DT=[$2], SELLER_ID=[$7], PRICE=[$8], ctx=[])
          KapFilterRel(condition=[AND(>=($7, 1), <=($7, 100))], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
        KapProjectRel(CAL_DT=[$2], SELLER_ID=[$7], PRICE=[$8], ctx=[])
          KapFilterRel(condition=[AND(>=($7, 200), <=($7, 300))], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query10.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapAggregateRel(group-set=[[]], groups=[null], EXPR$0=[COUNT(DISTINCT $0)], ctx=[])
    KapProjectRel($f0=[CASE(AND(=($0, 2012-10-30), >($1, 1)), $2, null)], ctx=[])
      KapUnionRel(all=[false], ctx=[], all=[false])
        KapProjectRel(CAL_DT=[$2], SELLER_ID=[$7], PRICE=[$8], ctx=[])
          KapFilterRel(condition=[AND(>=($7, 1), <=($7, 100))], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
        KapProjectRel(CAL_DT=[$2], SELLER_ID=[$7], PRICE=[$8], ctx=[])
          KapFilterRel(condition=[AND(>=($7, 200), <=($7, 300))], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
]]>
        </Resource>
        <Resource name="query11.planBefore">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapSortRel(sort0=[$0], sort1=[$1], dir0=[ASC-nulls-first], dir1=[ASC-nulls-first], ctx=[])
    KapAggregateRel(group-set=[[0, 1]], groups=[null], EXPR$2=[COUNT(DISTINCT $2)], ctx=[])
      KapProjectRel(CAL_DT=[$2], ACCOUNT_COUNTRY=[$42], $f2=[CASE(=($42, 'US'), $8, null)], ctx=[])
        KapFilterRel(condition=[AND(>=($2, 2012-01-01), <($2, 2012-02-01), OR(=($42, 'US'), =($42, 'CN')))], ctx=[])
          KapJoinRel(condition=[=($7, $39)], joinType=[inner], ctx=[])
            KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
            KapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
]]>
        </Resource>
        <Resource name="query11.planAfter">
            <![CDATA[
KapOLAPToEnumerableConverter
  KapSortRel(sort0=[$0], sort1=[$1], dir0=[ASC-nulls-first], dir1=[ASC-nulls-first], ctx=[])
    KapAggregateRel(group-set=[[0, 1]], groups=[null], AGG$0=[BITMAP_COUNT($2)], ctx=[])
      KapProjectRel(CAL_DT=[$0], ACCOUNT_COUNTRY=[$1], $f2=[CASE(=($2, 'US'), $3, null)], ctx=[])
        KapAggregateRel(group-set=[[0, 1, 2]], groups=[null], COUNT_DISTINCT_CASE$0$0=[BITMAP_UUID($3)], ctx=[])
          KapProjectRel(CAL_DT=[$2], ACCOUNT_COUNTRY=[$42], ACCOUNT_COUNTRY0=[$42], PRICE=[$8], $f4=[0], ctx=[])
            KapFilterRel(condition=[AND(>=($2, 2012-01-01), <($2, 2012-02-01), OR(=($42, 'US'), =($42, 'CN')))], ctx=[])
              KapJoinRel(condition=[=($7, $39)], joinType=[inner], ctx=[])
                KapTableScan(table=[[DEFAULT, TEST_KYLIN_FACT]], ctx=[], fields=[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]])
                KapTableScan(table=[[DEFAULT, TEST_ACCOUNT]], ctx=[], fields=[[0, 1, 2, 3, 4]])
]]>
        </Resource>
    </TestCase>
</Root>
SELECT (CASE WHEN ('1' = '1') THEN "TEST_CATEGORY_GROUPINGS"."USER_DEFINED_FIELD1" WHEN ('1' = '2') THEN "TEST_CATEGORY_GROUPINGS"."USER_DEFINED_FIELD3" ELSE "TEST_CATEGORY_GROUPINGS"."GROUPINGS_CRE_DATE" END) "XXX", SUM("PRICE") "SUM_PRICE"
FROM "TEST_KYLIN_FACT"
INNER JOIN "EDW"."TEST_CAL_DT" "TEST_CAL_DT" ON ("TEST_KYLIN_FACT"."CAL_DT" = "TEST_CAL_DT"."CAL_DT")
INNER JOIN "TEST_CATEGORY_GROUPINGS" ON (("TEST_KYLIN_FACT"."LEAF_CATEG_ID" = "TEST_CATEGORY_GROUPINGS"."LEAF_CATEG_ID") AND ("TEST_KYLIN_FACT"."LSTG_SITE_ID" = "TEST_CATEGORY_GROUPINGS"."SITE_ID"))
INNER JOIN "EDW"."TEST_SITES" "TEST_SITES" ON ("TEST_KYLIN_FACT"."LSTG_SITE_ID" = "TEST_SITES"."SITE_ID")
WHERE ((CASE WHEN ('A' = 'A') THEN ("TEST_KYLIN_FACT"."CAL_DT" < DATE '2010-01-02') WHEN ('A' = 'Z') THEN ("TEST_CAL_DT"."WEEK_BEG_DT" > DATE '2010-01-01') ELSE ("TEST_KYLIN_FACT"."LSTG_SITE_ID" IS NOT NULL) END) AND ("LSTG_FORMAT_NAME" = 'A'))
GROUP BY (CASE WHEN ('1' = '1') THEN "TEST_CATEGORY_GROUPINGS"."USER_DEFINED_FIELD1" WHEN ('1' = '2') THEN "TEST_CATEGORY_GROUPINGS"."USER_DEFINED_FIELD3" ELSE "TEST_CATEGORY_GROUPINGS"."GROUPINGS_CRE_DATE" END)
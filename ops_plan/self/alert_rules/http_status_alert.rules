groups:
- name: http_status_alert
  rules:

  - alert: Cube Build Request Error Too Many Times
    expr: increase(http_server_requests_seconds_count{uri=~"/api/models/.+/segments",method="POST",status=~"4..|5.."}[5m]) > 3
    for: 1m
    labels:
      severity: signification
    annotations:
      summary: "{{$labels.job}} Instance {{$labels.instance}} cube build requests failed too many times"
      description: "{{$labels.job}} Instance {{$labels.instance}} cube build requests(/api/models/{.+}/segments) failed times has been > 3 in last 5 minutes"

